---
title: "mcp å®¢æˆ·ç«¯å®æ“"
date: 2025-08-10 00:00:00 +0000
categories: [ai]
tags: [ai]
published: true
description: MCP æ˜¯ä»€ä¹ˆï¼Œä¸ºä»€ä¹ˆè¦ç”¨MCPï¼Œä»¥åŠåœ¨å®¢æˆ·ç«¯æ€ä¹ˆç”¨ï¼Ÿ
---

åœ¨[ä¸ªäººä»£ç†](https://www.jakobhe.com/posts/personal-agent/)çš„æ–‡ç« é‡Œï¼Œæˆ‘ä»¬åˆ©ç”¨vs codeæ’ä»¶é“¾æ¥äº†ä¸€ä¸ªatlassianæœ¬åœ°MCPæœåŠ¡ï¼Œå¹¶ä¸”è¿æ¥ä¸Šï¼Œèƒ½å¤Ÿè‡ªç”¨çš„ä½¿ç”¨é‡Œé¢çš„æ‰€æœ‰toolsã€‚

## ä¸ºä»€ä¹ˆè¦ç”¨MCPæœåŠ¡ï¼Ÿ

MCPæ˜¯ä¸€ä¸ªç®€å•çš„æŠ½è±¡å’Œå¤ç”¨ï¼Œåªéœ€è¦æœåŠ¡ï¼ˆèƒ½åŠ›ï¼‰æä¾›å•†ï¼Œä¸€æ¬¡å®šä¹‰å¥½èƒ½åŠ›çš„ä¸Šä¸‹æ–‡ï¼Œå°±èƒ½å¤Ÿçµ¦æ‰€æœ‰çš„æœåŠ¡ä½¿ç”¨è€…å¿«é€Ÿæ¥å…¥aiçš„èƒ½åŠ›ã€‚å¦‚æœæ²¡æœ‰MCPï¼Œæ¯ä¸ªæœåŠ¡çš„ä½¿ç”¨æ–¹ï¼Œéƒ½åœ¨å¯¹ä¸åŒçš„toolså®šä¹‰è‡ªå·±çš„promptï¼Œä¸åŒå…¶çƒ¦çš„é‡å¤å‘Šè¯‰aiä¸€æ ·çš„äº‹æƒ…ï¼Œè€Œä¸”ç”±äºæ¯ä¸ªäººè¡¨è¾¾èƒ½åŠ›å’Œä¾§é‡ä¸ä¸€æ ·ï¼Œå¯¼è‡´ä¸€æ ·çš„tools ä½¿ç”¨çš„çœŸå®æ•ˆæœä¹Ÿåƒå·®ä¸‡åˆ«ã€‚

## ä»€ä¹ˆæ—¶å€™éœ€è¦å®šä¹‰è‡ªå·±çš„MCPæœåŠ¡

- æœ‰å¤šä½™1ä¸ªçš„agent éœ€è¦æ¥å…¥ä½ æä¾›çš„toolsæ—¶
- ä½ æƒ³è§„èŒƒtools çš„å®šä¹‰æ—¶

æˆ‘ä»¬çš„é¡¹ç›®ï¼Œä¸€å¼€å§‹è®¡åˆ’åªå¼€æ”¾1-2ä¸ªtoolsï¼Œå¹¶ä¸”è°ƒç”¨æ–¹æ³•çš„agent ç›®å‰ä¹Ÿå°±åªæœ‰ä¸€ä¸ªã€‚ä½†æ˜¯åœ¨çœŸæ­£å®ç°toolçš„ä¸Šä¸‹æ–‡æ—¶ï¼Œæˆ‘ä»¬å‘ç°toolsçš„å®šä¹‰å’Œå¼€å‘ä¹Ÿéå¸¸çš„æ²¡æœ‰è§„èŒƒç§‘ç ”ï¼Œå¯å¤æ‚ï¼Œå¯ç®€å•ã€‚äºæ˜¯æˆ‘ä»¬å†³å®šï¼Œå³ä½¿åªæœ‰ä¸€ä¸ªagentï¼Œæˆ‘ä»¬ä¹Ÿè¦ç”¨MCPæ¥å®šä¹‰toolsã€‚

aiçš„è§„èŒƒåŒ–æ˜¯ç›®å‰é˜¶æ®µçš„ä¸€ä¸ªå¤§è¶‹åŠ¿ï¼Œæ— è®ºæ˜¯MCPï¼Œè¿˜æ˜¯AG-UIï¼ŒA2Aï¼ŒA2Cï¼Œå¤§å®¶éƒ½æ˜¯åœ¨å°è¯•è®©aiæ›´åŠ çš„è§„èŒƒåŒ–ï¼Œå‡å°‘å¹»è§‰ï¼Œå‡å°‘é‡å¤åŠ³åŠ¨ã€‚

## å®æ“å§

ä»Šå¤©çš„å®æ“ä¸­ï¼Œæˆ‘ä»¬ä¼š
1. åˆ©ç”¨docker å’Œç°æˆçš„mcp é•œåƒï¼Œåœ¨æœ¬åœ°å¯åŠ¨ä¸€ä¸ªmcp æœåŠ¡ï¼ˆä¹Ÿå¯çœ‹æˆæ˜¯ä¸€ä¸ªè¿œç¨‹MCP æœåŠ¡ï¼‰
2. æŠŠmcp æœåŠ¡ï¼Œæ³¨å†Œåˆ°agenté‡Œ
3. å¯åŠ¨æˆ‘ä»¬çš„agentï¼Œè¯•ç”¨å¯¹åº”çš„tools

### å¼€å§‹ä¹‹å‰
æˆ‘ä»¬éœ€è¦å…ˆå›ç­”å‡ ä¸ªé—®é¢˜ï¼Œ

#### running in client side or server side?

- è¿è¡Œåœ¨client side çš„ä¼˜ç‚¹æ˜¯æƒé™æ§åˆ¶ï¼Œå’Œè¯»å–æ›´å¤šæœ¬åœ°è¿è¡Œç¯å¢ƒçš„èƒ½åŠ›ã€‚
- è¿è¡Œåœ¨server side çš„ä¼˜ç‚¹æ˜¯ï¼Œèƒ½å¤Ÿå‡å°‘ç”¨æˆ·æ‰€éœ€è¦é…ç½®çš„ä¿¡æ¯ï¼Œå¦‚æœä½ çš„å®¢æˆ·æ˜¯éè½¯ä»¶å¼€å‘äººå‘˜ï¼Œä½ å°±éœ€è¦ä¸€ä¸ªè¿œç¨‹çš„MCPæœåŠ¡å’Œä¸€ä¸ªå·²ç»é«˜åº¦é›†æˆå¥½çš„agentå®¢æˆ·ç«¯ã€‚

é™¤äº†ä»¥ä¸Šçš„åŒºåˆ«å¤–ï¼Œè¿˜éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œåœ¨ä½ è®¾è®¡çš„agenté‡Œæ‰€æ³¨å†Œçš„toolsé‡Œï¼Œè¦å¦‚ä½•å¤„ç†å¥½æˆæƒå’Œæ•°æ®å®‰å…¨é—®é¢˜ï¼Ÿ

| # | Agent è¯»å†™èƒ½åŠ›ï¼Ÿ | remote or localï¼Ÿ |
|---|-------------|------------------|
| 1 | åªè¯»          | remote           |
| 2 | åªè¯»          | local            |
| 3 | è¯»å†™          | remote              |
| 4 | è¯»å†™          | local              |

è¿™é‡Œæœ‰å››ä¸ªcaseï¼Œåœ¨åªè¯»caseä¸‹ï¼Œæ— è®ºæ˜¯æœ¬åœ°å’Œè¿œç¨‹ï¼Œéƒ½ä¸å¤ªéœ€è¦å…³æ³¨æˆæƒé—®é¢˜ï¼ˆç»å¤§éƒ¨åˆ†åœºæ™¯ï¼‰ï¼Œé™¤éä¸Šå¸‚å…¬å¸ï¼Œéœ€è¦å¯¹è¯»å–å’Œå†™éƒ½æœ‰ä¸¥æ ¼çš„audit logã€‚

é‚£ä¹ˆåœ¨localçš„mcpæœåŠ¡ï¼Œä¹Ÿå°±æ˜¯è¿è¡Œåœ¨å®¢æˆ·ç«¯ä¸€ä¾§çš„MCPæœåŠ¡ï¼Œå¯ä»¥ç»™æ¯ä¸ªå®¢æˆ·éƒ½å¯åŠ¨ä¸€ä¸ªMCPé“¾æ¥ï¼Œæ¯ä¸ªMCPé“¾æ¥ä¹Ÿåªæœ‰ä¸€ä¸ªç”¨æˆ·tokenä¿¡æ¯çš„ç®¡ç†ï¼Œå®ƒå°±èƒ½å¾ˆè½»æ¾çš„çŸ¥é“æ‰€æœ‰æ“ä½œå¯¹åº”çš„ç”¨æˆ·ä¿¡æ¯ã€‚

è¿è¡Œåœ¨remoteçš„mcpæœåŠ¡ï¼Œåœ¨è®¾è®¡çš„æ¯”è¾ƒå¥½çš„æƒ…å†µä¸‹æ˜¯ï¼ŒæœåŠ¡è®°å½•å¥½æ¯ä¸ªç”¨æˆ·çš„ç™»é™†ä¿¡æ¯ï¼Œå†æ ¹æ®å®¢æˆ·ç«¯çš„è¯·æ±‚æ¥åŒºåˆ†ç”¨æˆ·ï¼Œå†ç”¨å¯¹åº”çš„ç”¨æˆ·ä¿¡æ¯æ¥æ“ä½œtoolsã€‚

è®¾è®¡çš„ä¸€èˆ¬çš„MCP remote æœåŠ¡ï¼Œåˆ™æ˜¯ç”¨ä¸€ä¸ªé€šç”¨è´¦å·ï¼Œæ¯”å¦‚æŸproject è´¦å·ï¼Œæ¥é€šç”¨çš„æ“ä½œæ‰€æœ‰çš„â€œè¯»â€caseï¼Œå¿½ç•¥æ‰€æœ‰çš„audit log éœ€æ±‚ã€‚

è®¾è®¡çš„æœ€ç³Ÿçš„MCP remote æœåŠ¡ï¼Œåˆ™æ˜¯å¿½ç•¥ä»»ä½•ç”¨æˆ·â€œè¯»å†™â€æƒé™ï¼Œåªç”¨é€šç”¨è´¦å·æ¥è¿›è¡Œæ‰€æœ‰æ“ä½œã€‚

åœ¨ä»Šå¤©çš„å®æ“é‡Œï¼Œæˆ‘ä»¬å¯åŠ¨ä¸€ä¸ªdocker é•œåƒï¼Œç”¨ä¸€ä¸ªé€šç”¨è´¦æˆ·æ¥æ“ä½œæ‰€æœ‰çš„è¯»æ“ä½œã€‚


### å¼€å§‹ï¼ç¬¬ä¸€æ­¥ï¼šå®šä¹‰ï¼Œå¯åŠ¨æˆ‘ä»¬çš„MCP æœåŠ¡

ä»Šå¤©æˆ‘ä»¬ç”¨è¿™ä¸ªé•œåƒï¼š
https://hub.docker.com/r/mcp/atlassian

å¤šè¯´ä¸€ç‚¹ï¼ŒMCPé•œåƒæœ€è¿‘å±‚å‡ºä¸ç©·ï¼Œæœ€å¥½ä½¿ç”¨å®˜æ–¹æä¾›çš„é•œåƒï¼Œæˆ–è€…æ˜¯çº¯è‡ªå·±å¼€å‘çš„é•œåƒï¼Œå¦åˆ™ä¼šæœ‰ä¸€äº›é—®é¢˜ï¼Œæ¯”å¦‚ï¼š
1. tools ä¸Šä¸‹æ–‡æè¿°å’Œå®šä¹‰ä¸å¤Ÿå‡†ç¡®
2. å®‰å…¨é—®é¢˜ï¼Œæ¯”å¦‚æœ‰äººæ¶æ„æ³¨å…¥ä¸€äº›ä¸å®‰å…¨çš„ä¸Šä¸‹æ–‡ï¼Œä¹±æ“ä½œä½ çš„æœåŠ¡

```bash
docker run -i --rm -p 8000:8000 \
  -e JIRA_URL="https://meme.atlassian.net" \
  -e JIRA_USERNAME="svc.dev.atlassian@meme.com" \
  -e JIRA_API_TOKEN="your_api_token_here" \
  mcp/atlassian:latest \
  --transport sse -vv
```

from æ–‡æ¡£ï¼š
> ğŸ‘¥ HTTP Transport Configuration
> Instead of using stdio, you can run the server as a persistent HTTP service using either:
> 
> - sse (Server-Sent Events) transport at /sse endpoint
> - streamable-http transport at /mcp endpoint

![Image](/2025-08-10-mcp-client/1.jpg)

è¿è¡Œå¥½ä¹‹åï¼Œå¯ä»¥ç”¨postman éªŒè¯ä¸€ä¸‹å¯åŠ¨æƒ…å†µï¼š

![Image](/2025-08-10-mcp-client/2.jpg)

### ç¬¬äºŒæ­¥ï¼šå®šä¹‰ä¸€ä¸ªagent

æˆ‘ä»¬è¿˜æ˜¯ç”¨ADKæ¥ï¼Œå…ˆæŒ‰[ç”¨ADKè¿è¡Œä¸€ä¸ªagent](https://www.jakobhe.com/posts/agent-workshop-1/)é‡Œå†™çš„æ¡†æ¶æ¥åˆ›å»ºä¸€ä¸ªagentï¼Œä¸“é—¨ç”¨æ¥å¤„ç†jira summarizeã€‚

```java
public static List<BaseTool> integrateJiraMCP() {
    SseServerParameters serverParameters = SseServerParameters.builder().url("http://127.0.0.1:8000/sse")
        .timeout(Duration.ofMinutes(1)).sseReadTimeout(Duration.ofMinutes(1))
        .build();
    McpToolset.McpToolsAndToolsetResult toolsAndToolsetResult;
    try {
        toolsAndToolsetResult = McpToolset.fromServer(serverParameters).get();
    } catch (Exception e) {
        throw new RuntimeException("Connect JIRA MCP server failed", e);
    }
    Set<String> supportTools = Set.of("jira_get_issue", "jira_search");
    return toolsAndToolsetResult.getTools().stream().filter(mcpTool -> supportTools.contains(mcpTool.name())).map(mcpTool -> (BaseTool) mcpTool).toList();
}
```

æ³¨å†Œä½ çš„MCP æœåŠ¡
```java
public static BaseAgent initAgent() {
    return LlmAgent.builder()
        .name(NAME)
        .model("gemini-2.0-flash")
        .description("Agent to summarize, organize jira tickets. There is a jira board to manage all tasks for MasterData team.")
        .instruction(
            "You are a helpful agent who can answer user questions about the jira tickets.")
        .tools(integrateJiraMCP())
        .build();
}
```

éªŒè¯ä¸€ä¸‹:
![Image](/2025-08-10-mcp-client/3.JPG)

### å¥½äº†ï¼æ¥ä¸‹æ¥é›†æˆeverythingå§ã€‚

æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°±èƒ½ç”¨agentâ€œæœ‰æœºâ€çš„æŠŠå„ç§æœåŠ¡é›†æˆåœ¨ä¸€èµ·äº†ï¼Œæ›¾ç»çš„é›†æˆæ˜¯æ¯”è¾ƒâ€œæ­»â€çš„ï¼Œæ²¡æœ‰æ™ºèƒ½å¯è¨€ã€‚

æ‹¿ç»å…¸çš„ifttt æ¥è¯´ï¼ŒåŸºæœ¬ä¸Šå°±æ˜¯ä¸€ä¸ªtrigger+ åšå¾ˆå¤šå¾ˆå¤šçš„äº‹æƒ…ã€‚æ¯”å¦‚æ”¶åˆ°ä¸€å°é‚®ä»¶ï¼Œå¸¦æœ‰post twitterçš„å…³é”®å­—ï¼Œå°±å‘å¸ƒtwitterï¼Œyoutubeï¼Œinsã€‚

ä»€ä¹ˆæ˜¯æ´»çš„integrationå‘¢ï¼Ÿé‚£å°±æ˜¯ç”±agentæ¥å†³ç­–æ‰€éœ€è¦åšçš„äº‹æƒ…ï¼Œæ¯”å¦‚ï¼š
æ”¶åˆ°ä¸€ä»½å‘½ä»¤é‚®ä»¶ï¼Œåˆ™ç»§ç»­æ“ä½œå‘å¸ƒç¤¾äº¤åª’ä½“ï¼Œä½†æ˜¯ä¾æ®é‚®ä»¶å†…å®¹çš„ä¸åŒæƒ…å†µï¼Œåšä¸åŒçš„æ“ä½œï¼š
1. æ–‡å­—å°‘çš„æ—¶å€™å‘twitter
2. æ–‡å­—å¤šçš„æ—¶å€™ç”Ÿæˆç¼©ç•¥å›¾åå†å‘twitter
3. å¸¦æœ‰å¤šå›¾ç‰‡çš„æ—¶å€™å‘ins+twitter
4. å¸¦è§†é¢‘é“¾æ¥çš„æ—¶å€™ï¼Œä¸‹è½½ä¸‹æ¥å‘youtube

## æœ‰é‚£ä¹ˆä¸€ä¸ªå°å°çš„ç¼ºç‚¹ï¼Œä¹Ÿæœ‰å¯¹åº”çš„è§£å†³æ–¹æ¡ˆã€‚
å½“ç„¶MCP å¦‚æ­¤æ–¹ä¾¿ï¼Œå¸¦æ¥äº†ä¸€äº›ä»£ä»·ï¼Œç¡•å¤§çš„å·¥å…·åº“å†—ä½™äº†éå¸¸å¤šçš„tools åŠ¨è¾„å‡ åä¸ªï¼Œä¸Šç™¾ä¸ªã€‚è¿™å¯¹tokençš„æ¶ˆè€—æ˜¯æ— æ„Ÿä¸”ææ€–çš„ï¼Œä¸çŸ¥ä¸è§‰é¢„ç®—å°±ä¸Šå»äº†ã€‚

è€Œä¸”å®é™…æƒ…å†µæ˜¯ï¼Œæˆ‘åœ¨ä¸€ä¸ªä»»åŠ¡çš„æ‰§è¡Œæ—¶ï¼Œå¹¶ä¸éœ€è¦ç”¨åˆ°å¦‚æ­¤ä¹‹å¤šçš„toolsï¼Œç”šè‡³è®¸å¤štools çš„èƒ½åŠ›ä¼šå¯¹agent çš„åˆ¤æ–­å½¢æˆå¹²æ‰°ï¼Œåšå‡ºæ²¡å¿…è¦æ‰§è¡Œçš„åŠ¨ä½œã€‚ è™½ç„¶æœªæ¥ä¸€å®šæ˜¯tokenä¾¿å®œçš„æ—¶ä»£ï¼Œè¿™äº›å·¨é‡çš„toolså¹²æ‰°ä¹Ÿæˆä¸ºäº†ä¸€ä¸ªagentä¸ç¨³å®šçš„å› ç´ ã€‚

æ‰€ä»¥å‘¢ï¼Œåœ¨è¿™æ ·çš„ç¼ºç‚¹é¢å‰ï¼Œæˆ‘ä»¬è¿˜æœ‰å¦å¤–ä¸¤ä¸ªè§£å†³æ–¹æ¡ˆ

1. å‡ºé—¨æ‰§è¡Œä»»åŠ¡å‰ï¼Œå…ˆæŒ‘é€‰ä½ çš„è£…å¤‡: æ¯”å¦‚æˆ‘ä»Šå¤©æ˜¯å»çŒæ€æé¾™ï¼Œé‚£ä¹ˆæˆ‘å¸¦çš„è£…å¤‡ä¸€å®šæ˜¯å’Œå»æ»‘é›ªä¸ä¸€æ ·çš„ã€‚ä½†æ˜¯è¿™å±‚åˆ¤æ–­å°±æ˜¾å¾—AIä¸æ˜¯é‚£ä¹ˆâ€œæ™ºèƒ½â€äº†ï¼
2. distributed agent(A2A): å…ˆç”±ä¸€ä¸ªæ€»ç®¡agent å†³å®šè°ƒç”¨çš„agent åº“ï¼Œç”šè‡³è¿™ä¸ªå†³ç­–agent å¯ä»¥æ˜¯å¤šå±‚çš„å†³ç­–ï¼Œä»ç²—åˆ°ç»†ï¼Œå±‚å±‚å¾€ä¸‹ï¼Œæœ€ç»ˆåˆ°æ‰§è¡Œtoolçš„agentï¼Œæˆ‘ä»¬å¯ä»¥è¯´è¿™å±‚å…·å¤‡æ‰§è¡Œèƒ½åŠ›çš„agent å«â€œåŸºå±‚â€ã€‚å“ˆå“ˆå“ˆ

## å…¬å¸çš„è€æ€»ä»¬ï¼Œå¾ˆå¿«å°±èƒ½åƒç®¡äººä¸€æ ·ç®¡agentäº†

å…¬å¸çš„è€æ€»ä»¬ï¼Œç«™åœ¨A2Açš„æ€è€ƒæ¡†æ¶ä¸‹ï¼Œå°±èƒ½åƒæ€è€ƒç»´æœåŠ¡ä¸€æ ·ï¼ŒæŠŠä¸€ä¸ªä¸€ä¸ªçš„åŸºå±‚agentä½œä¸ºå‡ºå‘ç‚¹ï¼Œå½“åŸºå±‚agent è¾¾åˆ°ä¸€å®šæ•°é‡ä¹‹åï¼Œå†å¯¹ä¸šåŠ¡è¿›è¡Œä¸€å®šçš„æŠ½è±¡ï¼Œåœ¨æ•°é‡æ€»å¤šçš„åŸºå±‚agentä¹‹ä¸Šå¼€å‘ä¸€ä¸ªmanager agentåšæ›´å¤§çš„äº‹æƒ…ã€‚

AIçš„å¾®æœåŠ¡æ¥çš„å¦‚æ­¤ä¹‹å¿«ï¼Œæˆ‘ä¼°è®¡è¿™é‡Œé¢çš„åŸå› è·Ÿaiâ€œåƒâ€äººæ˜¯æœ‰å…³çš„ï¼Œå°†æ¥å…¬å¸çš„è½¯ä»¶éƒ¨é—¨çš„ç®¡ç†ï¼Œèƒ½å¤Ÿå¾ˆå®¹æ˜“çš„æŠŠè½¯ä»¶å½“ä½œâ€œäººâ€æ¥çœ‹ï¼Œå½“ä½œâ€œäººâ€æ¥ç®¡ã€‚
